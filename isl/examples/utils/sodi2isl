#!/bin/bash

# Pawe³ Pa³ucha 2002
# This script transforms SVG created by Sodipodi version 0.24.1 to ISL file.
# Changes made to original file:
#  - standalone="no" -> "yes" (in XML declaration)
#  - removing of DOCTYPE declaration
#  - changing '\X' strings to corresponding Polish letters (UTF-8 encoded)
#  - adding "isl" namespace declaration

# Usage: sodi2isl <input_file> <output_file>

[ $# -ne 2 ] && {
	echo "Converting Sodipodi 0.24 SVG files to ISL SVG format."
	echo "Usage: sodi2isl <input_file> <output_file>"
	exit
}

TMP=sodi2isl_temp.~

sed 's/standalone="no"/standalone="yes"/' $1 | \
sed 's/\\a/Ä…/g' | \
sed 's/\\A/Ä„/g' | \
sed 's/\\c/Ä‡/g' | \
sed 's/\\C/Ä†/g' | \
sed 's/\\e/Ä™/g' | \
sed 's/\\E/Ä˜/g' | \
sed 's/\\l/Å‚/g' | \
sed 's/\\L/Å/g' | \
sed 's/\\n/Å„/g' | \
sed 's/\\N/Åƒ/g' | \
sed 's/\\o/Ã³/g' | \
sed 's/\\O/Ã“/g' | \
sed 's/\\s/Å›/g' | \
sed 's/\\S/Åš/g' | \
sed 's/\\z/Å¼/g' | \
sed 's/\\Z/Å»/g' | \
sed 's/\\x/Åº/g' | \
sed 's/\\X/Å¹/g' | \
sed 's/\\0/Â°/g' > $TMP
rm -f $2
I=1
cat $TMP | while read LINE ; do {
	[ $I -ne 2 ] && [ $I -ne 3 ] && echo "$LINE" >> $2
	[ $I -eq 5 ] && echo "xmlns:isl=\"http://www.praterm.com.pl/ISL/params\"" >> $2
	I=$(($I+1))
} ; done
rm -f $TMP

